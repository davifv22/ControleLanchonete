{% extends 'panel/home.html' %}
{% block panel %}
<br>
<h3 style="text-align: center;">PEDIDOS</h3>
<hr>
<div class="d-flex justify-content-around flex-wrap">
    {% for pedido in all_pedidos %}
    <table class="printer-ticket m-2">
        <thead>
            <tr>
                <th colspan="3">
                    <b>Cliente: {{ pedido.name_client }}</b> <br>
                    Tel: {{ pedido.tel }} <br>
                    <b>Pedido: #{{ pedido.id }}</b> <br>
                    Data: {{ pedido.order_time }}
                </th>
            </tr>
            <tr>
                <th class="ttu" colspan="3">
                    {% if pedido.situation == 'PENDENTE' %}
                    <b class="situacao bg-danger">PENDENTE</b>
                    {% elif pedido.situation == 'EM ANDAMENTO' %}
                    <b class="situacao bg-secondary">EM ANDAMENTO</b>
                    {% elif pedido.situation == 'EM ENTREGA' %}
                    <b class="situacao bg-success">EM ENTREGA</b>
                    {% elif pedido.situation == 'RETIRAR' %}
                    <b class="situacao bg-success">RETIRAR</b>
                    {% endif %}
                </th>
            </tr>
        </thead>
        <tbody>
            <tr class="top">
                <td colspan="3">Endere√ßo: {{ pedido.address }}</td>
            </tr>
            <tr>
                <td colspan="3">Pagamento:</td>
            </tr>
            <tr>
                <td>Total itens:</td>
                <td>5.0</td>
                <td>R$ 43,60</td> <!-- pegar soma da tab. pedidos_items -->
            </tr>
        </tbody>
        <tfoot>
            <tr class="sup ttu p--0">
                <td colspan="3">
                    <b>Totais</b>
                </td>
            </tr>
            <tr class="ttu">
                <td colspan="2">Sub-total</td>
                <td align="right">R$ 43,60</td> <!-- pegar soma da tab. pedidos_items -->
            </tr>
            {% if pedido.delivery == 'SIM' %}
            <tr class="ttu">
                <td colspan="2">Entrega</td>
                <td align="right">R$ 4,60</td>
            </tr>
            {% else %}
            <tr class="ttu">
                <td colspan="2">Entrega</td>
                <td align="right">R$ 0,00</td>
            </tr>
            {% endif %}
            <tr class="ttu">
                <td colspan="2">Total</td>
                <td align="right">R$ {{ pedido.amount }}</td>
            </tr>

            <tr class="sup">
                <td colspan="3" align="center">
                    <div class="d-flex justify-content-center">
                        {% if pedido.situation == 'PENDENTE' %}
                        <a href="{{pedido.id}}/prepare/change_order" class="btn btn-success btn-sm m-1">Preparar</a>
                        {% elif pedido.situation == 'EM ANDAMENTO' %}
                        <a href="{{pedido.id}}/deliver/change_order" class="btn btn-success btn-sm m-1">Entregar</a>
                        {% elif pedido.situation == 'EM ENTREGA' %}
                        <a href="{{pedido.id}}/finalize/change_order" class="btn btn-success btn-sm m-1">Entregue</a>
                        {% elif pedido.situation == 'RETIRAR' %}
                        <a href="{{pedido.id}}/finalize/change_order" class="btn btn-success btn-sm m-1">Retirado</a>
                        {% endif %}
                        <button type="button" class="btn btn-primary btn-sm m-1" data-bs-toggle="modal"
                            data-bs-target="#{{ pedido.id }}">Detalhes</button>
                        <a href="{{pedido.id}}/cancel/change_order" class="btn btn-danger btn-sm m-1">Cancelar</a>
                    </div>
                </td>
            </tr>
        </tfoot>
    </table>
    {% endfor %}
</div>
{% endblock %}